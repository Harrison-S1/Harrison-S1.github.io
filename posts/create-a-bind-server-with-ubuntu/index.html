<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Create a bind server with Ubuntu" /><meta property="og:locale" content="en" /><meta name="description" content="Install Bind" /><meta property="og:description" content="Install Bind" /><link rel="canonical" href="/posts/create-a-bind-server-with-ubuntu/" /><meta property="og:url" content="/posts/create-a-bind-server-with-ubuntu/" /><meta property="og:site_name" content="Sam’s 2nd brain" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-19T14:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Create a bind server with Ubuntu" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-20T14:27:17+00:00","datePublished":"2022-06-19T14:00:00+00:00","description":"Install Bind","headline":"Create a bind server with Ubuntu","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/create-a-bind-server-with-ubuntu/"},"url":"/posts/create-a-bind-server-with-ubuntu/"}</script><title>Create a bind server with Ubuntu | Sam's 2nd brain</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Sam's 2nd brain"><meta name="application-name" content="Sam's 2nd brain"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/54186142?s=400&u=fabf11da8c31b3afad7d8fbc76732b43734a685c&v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Sam's 2nd brain</a></div><div class="site-subtitle font-italic">brain of brain</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Harrison-S1" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Create a bind server with Ubuntu</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Create a bind server with Ubuntu</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1655647200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 19, 2022 </em> </span> <span> Updated <em class="" data-ts="1655735237" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 20, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">Sam</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1211 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><h3 id="install-bind"><span class="mr-2">Install Bind</span><a href="#install-bind" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><em>This guide assumes you are using Ubuntu 20.04 and have already install and setup the server.</em></p><p>Install the require packages:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get <span class="nb">install </span>bind9 bind9utils bind9-doc
</pre></table></code></div></div><p>If you are only using IPV4 it is best practice to set bind to IPV4 mode. This is done by editing /etc/default/named file. Add “-4” to the end of the OPTIONS parameter. It should look like the following:</p><p>startup options for the server</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">OPTIONS</span><span class="o">=</span><span class="s2">"-u bind -4"</span>
</pre></table></code></div></div><p>Restart bind to apply the change with:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl restart bind9
</pre></table></code></div></div><h3 id="configuration-for-namedconfoption"><span class="mr-2">Configuration for named.conf.option</span><a href="#configuration-for-namedconfoption" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>vim /etc/bind/named.conf.options
</pre></table></code></div></div><p>Add a ACL (access control list). This will be servers that can access the DNS service. In the example below the example, the ACL is called “trusted”. You can call this list anything you want.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>acl <span class="s2">"trusted"</span> <span class="o">{</span>
        localhost<span class="p">;</span>         <span class="c"># This is your main host that your on</span>
        10.130.55.0/24<span class="p">;</span>    <span class="c"># This is a subnet that you will be allowing </span>
        10.130.55.12<span class="p">;</span>      <span class="c"># You can also add a host be host basis (more secure)</span>
<span class="o">}</span><span class="p">;</span>

</pre></table></code></div></div><p>Under directory “/var/cache/bind”;</p><p>add the following:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>        recursion <span class="nb">yes</span><span class="p">;</span>                 <span class="c"># enables resursive queries</span>
        allow-recursion <span class="o">{</span> trusted<span class="p">;</span> <span class="o">}</span><span class="p">;</span>  <span class="c"># allows recursive queries from "trusted" acl</span>
        listen-on <span class="o">{</span> hostip<span class="p">;</span> <span class="o">}</span><span class="p">;</span>         <span class="c"># Private IP address of your host- listen on private network only</span>
        allow-transfer <span class="o">{</span> none<span class="p">;</span> <span class="o">}</span><span class="p">;</span>      <span class="c"># disable zone transfers by default</span>

        forwarders <span class="o">{</span>
                1.1.1.1<span class="p">;</span>
                8.8.8.8<span class="p">;</span>
        <span class="o">}</span><span class="p">;</span>
</pre></table></code></div></div><p>Not that the forwarders IP will be needed if the DNS host does not have the recorder requested and needs to look to another DNS server. You config will look something like this:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre>acl <span class="s2">"trusted"</span> <span class="o">{</span>
        localhost<span class="p">;</span>         <span class="c"># This is your main host that your on</span>
        10.131.55.0/24<span class="p">;</span>    <span class="c"># This is a subnet that you will be allowing</span>
        10.131.55.120<span class="p">;</span>     <span class="c"># Secondary DNS server IP (if using a second)</span>
        10.131.55.110<span class="p">;</span>     <span class="c"># You can also add a host be host basis (more secure)</span>
<span class="o">}</span><span class="p">;</span>

options <span class="o">{</span>
        directory <span class="s2">"/var/cache/bind"</span><span class="p">;</span>

        recursion <span class="nb">yes</span><span class="p">;</span>                 <span class="c"># enables resursive queries</span>
        allow-recursion <span class="o">{</span> trusted<span class="p">;</span> <span class="o">}</span><span class="p">;</span>  <span class="c"># allows recursive queries from "trusted" acl</span>
        listen-on <span class="o">{</span> hostip<span class="p">;</span> <span class="o">}</span><span class="p">;</span>         <span class="c"># Private IP address of your host- listen on private network only</span>
        allow-transfer <span class="o">{</span> none<span class="p">;</span> <span class="o">}</span><span class="p">;</span>      <span class="c"># disable zone transfers by default</span>
 
        forwarders <span class="o">{</span>
                1.1.1.1<span class="p">;</span>
                8.8.8.8<span class="p">;</span>
        <span class="o">}</span><span class="p">;</span>


        // If there is a firewall between you and nameservers you want
        // to talk to, you may need to fix the firewall to allow multiple
        // ports to talk.  See http://www.kb.cert.org/vuls/id/800113 

        // If your ISP provided one or more IP addresses <span class="k">for </span>stable
        // nameservers, you probably want to use them as forwarders.
        // Uncomment the following block, and insert the addresses replacing
        // the all-0<span class="s1">'s placeholder.

        // forwarders {
        //      0.0.0.0;
        // };

       //========================================================================
       // If BIND logs error messages about the root key being expired,
       // you will need to update your keys.  See https://www.isc.org/bind-keys
       //========================================================================
       dnssec-validation auto;

       listen-on-v6 { any; };
};
</span></pre></table></code></div></div><p>Save and exit the file. The configuration specifies that only your servers (defined in the acl) will be able to query the DNS server for outside domains.</p><h3 id="configuration-for-namedconflocal"><span class="mr-2">Configuration for named.conf.local</span><a href="#configuration-for-namedconflocal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>vim /etc/bind/named.conf.local
</pre></table></code></div></div><p>Note that domain.com is being used as the example domain. you need to change this to your domain. Add the forward look up zone:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>zone <span class="s2">"domain.com"</span> <span class="o">{</span>
    <span class="nb">type </span>master<span class="p">;</span>
    file <span class="s2">"/etc/bind/zones/db.domain.com"</span><span class="p">;</span>       <span class="c"># zone file path</span>
    allow-transfer <span class="o">{</span> dns2ip<span class="p">;</span> <span class="o">}</span><span class="p">;</span>                 <span class="c"># Private IP address for secondary DNS server</span>
<span class="o">}</span><span class="p">;</span>
</pre></table></code></div></div><p>Now add the revers lookup zone</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>zone <span class="s2">"55.130.10.in-addr.arpa"</span> <span class="o">{</span>
    <span class="nb">type </span>master<span class="p">;</span>
    file <span class="s2">"/etc/bind/zones/db.10.130.55"</span><span class="p">;</span>  <span class="c"># 10.130.55.0/24 subnet</span>
    allow-transfer <span class="o">{</span> dns2ip<span class="p">;</span> <span class="o">}</span><span class="p">;</span>           <span class="c"># Private IP address for secondary DNS server</span>
<span class="o">}</span><span class="p">;</span>
</pre></table></code></div></div><p>Save and exit the file.</p><p>The zone configuration is now set, but we need to create the file for /etc/bind/zones/db.10.130.55 and /etc/bind/zones/db.domain.com</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">sudo mkdir</span> /etc/bind/zones
<span class="nb">sudo cp</span> /etc/bind/db.local /etc/bind/zones/db.domain.com
<span class="nb">sudo </span>vim /etc/bind/zones/db.domain.com
</pre></table></code></div></div><p>edit the following:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nv">$TTL</span>    604800
@       IN      SOA     localhost. root.localhost. <span class="o">(</span>
                              2         <span class="p">;</span> Serial
                         604800         <span class="p">;</span> Refresh
                          86400         <span class="p">;</span> Retry
                        2419200         <span class="p">;</span> Expire
                         604800 <span class="o">)</span>       <span class="p">;</span> Negative Cache TTL
<span class="p">;</span>
@       IN      NS      localhost.      <span class="p">;</span> delete this line
@       IN      A       127.0.0.1       <span class="p">;</span> delete this line
@       IN      AAAA    ::1             <span class="p">;</span> delete this line
</pre></table></code></div></div><p>Now you need to add your NS servers:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="p">;</span> name servers - A records
ns1.domain.com.          IN      A       10.130.55.10
ns2.domain.com.          IN      A       10.130.55.11
</pre></table></code></div></div><p>And then A records for your servers</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="p">;</span> 10.130.55.0/24 - A records
host1.domain.com.        IN      A      10.130.55.100
host2.domain.com.        IN      A      10.130.55.101
</pre></table></code></div></div><p>Save and exit the file. Now lets create the revers lookup zone.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo cp</span> /etc/bind/db.127 /etc/bind/zones/db.10.130.55
<span class="nb">sudo </span>vim /etc/bind/zones/db.10.130.55
</pre></table></code></div></div><p>edit the following: $TTL 604800 @ IN SOA localhost. root.localhost. (</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>                             1         <span class="p">;</span> Serial
                        604800         <span class="p">;</span> Refresh
                         86400         <span class="p">;</span> Retry
                       2419200         <span class="p">;</span> Expire
                        604800 <span class="o">)</span>       <span class="p">;</span> Negative Cache TTL

@ IN NS localhost. <span class="p">;</span> delete this line 1.0.0 IN PTR localhost. <span class="p">;</span> delete this line Add the NS servers

<span class="p">;</span> name servers - NS records
      IN      NS      ns1.domain.com.
      IN      NS      ns2.domain.com.

And <span class="k">then </span>the PTR records

<span class="p">;</span> PTR Records
11  IN      PTR     ns1.domain.com.    <span class="p">;</span> 10.130.55.10
12  IN      PTR     ns2.domain.com.    <span class="p">;</span> 10.130.55.11
100 IN      PTR     host1.domain.com.  <span class="p">;</span> 10.130.55.100
101 IN      PTR     host2.domain.com.  <span class="p">;</span> 10.130.55.101
</pre></table></code></div></div><p>Save and exit.</p><h3 id="configuration-check"><span class="mr-2">Configuration check</span><a href="#configuration-check" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Check the zone for syntax errors with:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>named-checkconf
</pre></table></code></div></div><p>Now check the correctness of the zone against the domain with:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>named-checkzone domain.com db.domain.com
<span class="nb">sudo </span>named-checkzone 55.130.10.in-addr.arpa /etc/bind/zones/db.10.130.55
</pre></table></code></div></div><p>If the report no errors you can now restart the bind service with</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl restart bind9
</pre></table></code></div></div><p>Allow bind traffic on the firewall with</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>ufw allow Bind9
</pre></table></code></div></div><h3 id="configuring-the-secondary-dns-serve"><span class="mr-2">Configuring the secondary DNS serve</span><a href="#configuring-the-secondary-dns-serve" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>On the second DNS host install the require packages</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get <span class="nb">install </span>bind9 bind9utils bind9-doc
</pre></table></code></div></div><p>Now edit the bind config and add:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>vim /etc/bind/named.conf.options
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>acl <span class="s2">"trusted"</span> <span class="o">{</span>

       10.130.55.10<span class="p">;</span>    <span class="c"># ns1</span>
       localhost<span class="p">;</span>       <span class="c"># ns2 - can be set to localhost</span>
       10.130.55.100<span class="p">;</span>   <span class="c"># single host1</span>
       10.130.55.0/24<span class="p">;</span>  <span class="c"># subnet</span>
<span class="o">}</span><span class="p">;</span>
</pre></table></code></div></div><p>Then as before add:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>        recursion <span class="nb">yes</span><span class="p">;</span>
        allow-recursion <span class="o">{</span> trusted<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
        listen-on <span class="o">{</span> 10.130.55.11<span class="p">;</span> <span class="o">}</span><span class="p">;</span>      <span class="c"># ns2 private IP address</span>
        allow-transfer <span class="o">{</span> none<span class="p">;</span> <span class="o">}</span><span class="p">;</span>          <span class="c"># disable zone transfers by default</span>

        forwarders <span class="o">{</span>
                1.1.1.1<span class="p">;</span>
                8.8.8.8<span class="p">;</span>
        <span class="o">}</span><span class="p">;</span>
</pre></table></code></div></div><p>Save and exit. Now edit options.local</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>vim /etc/bind/named.conf.local
</pre></table></code></div></div><p>And add the following:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>zone <span class="s2">"domain.com"</span> <span class="o">{</span>
    <span class="nb">type </span>slave<span class="p">;</span>
    file <span class="s2">"domain.com"</span><span class="p">;</span>
    masters <span class="o">{</span> 10.130.55.10<span class="p">;</span> <span class="o">}</span><span class="p">;</span>  <span class="c"># ns1 private IP</span>
<span class="o">}</span><span class="p">;</span>

zone <span class="s2">"55.130.10.in-addr.arpa"</span> <span class="o">{</span>
    <span class="nb">type </span>slave<span class="p">;</span>
    file <span class="s2">"db.10.130.55."</span><span class="p">;</span>
    masters <span class="o">{</span> 10.130.55.10<span class="p">;</span> <span class="o">}</span><span class="p">;</span>  <span class="c"># ns1 private IP</span>
<span class="o">}</span><span class="p">;</span>
</pre></table></code></div></div><h3 id="configuration-check-on-secondary-server"><span class="mr-2">Configuration check on secondary server</span><a href="#configuration-check-on-secondary-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Check the zone for syntax errors with:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>named-checkconf
</pre></table></code></div></div><p>If the report no errors you can now restart the bind service with</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl restart bind9
</pre></table></code></div></div><p>Allow bind traffic on the firewall with</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>ufw allow Bind9
</pre></table></code></div></div><p>Now you can configure your host to check the server are working.Use tools such as nslookup and dig.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/homelab/'>homelab</a>, <a href='/categories/howto-s/'>howto's</a>, <a href='/categories/linux/'>linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/homelab/" class="post-tag no-text-decoration" >homelab</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/howto-s/" class="post-tag no-text-decoration" >howto's</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Create+a+bind+server+with+Ubuntu+-+Sam%27s+2nd+brain&url=%2Fposts%2Fcreate-a-bind-server-with-ubuntu%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Create+a+bind+server+with+Ubuntu+-+Sam%27s+2nd+brain&u=%2Fposts%2Fcreate-a-bind-server-with-ubuntu%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2Fcreate-a-bind-server-with-ubuntu%2F&text=Create+a+bind+server+with+Ubuntu+-+Sam%27s+2nd+brain" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=%2Fposts%2Fcreate-a-bind-server-with-ubuntu%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/atlas-project-part-two/">Atlas project - part two</a><li><a href="/posts/atlas-project-part-one/">Atlas Project - part one</a><li><a href="/posts/aws-storage-gateway/">Creating a Storage Gateway in AWS</a><li><a href="/posts/Expanding-EBS-root-volume/">Expanding EBS root volume</a><li><a href="/posts/CloudWatch-Monitor-EC2-Linux-services-and-set-alarms/">CloudWatch Monitor EC2 Linux services and set alarms</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/howto-s/">howto's</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/sysops/">sysops</a> <a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/ansible/">ansible</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/terraform/">terraform</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Converting-with-ffmpeg/"><div class="card-body"> <em class="small" data-ts="1655474400" data-df="ll" > Jun 17, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Converting with ffmpeg</h3><div class="text-muted small"><p> Convert mp4 to mkv ffmpeg -i input.mp4 -codec copy output.mkv Tip: To convert all MP4 files in the current directory, run a simple loop in terminal: for i in *.mp4; do ffmpeg -i &quot;$i&quot; -c...</p></div></div></a></div><div class="card"> <a href="/posts/setting-up-nessus-pro/"><div class="card-body"> <em class="small" data-ts="1646920800" data-df="ll" > Mar 10, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Setting up Nessus Pro</h3><div class="text-muted small"><p> Build your server Download the package for your server. https://www.tenable.com/downloads/nessus For this example a Ubuntu server is being used. Copy the package to your service and for Ub...</p></div></div></a></div><div class="card"> <a href="/posts/rdp-to-debian/"><div class="card-body"> <em class="small" data-ts="1647352800" data-df="ll" > Mar 15, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>RDP to Debian</h3><div class="text-muted small"><p> Install xrdp. sudo apt install xrdp Now make sure to automatically start the service at the system startup. systemctl enable xrdp Then make sure that the service is running. systemctl status...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Converting-with-ffmpeg/" class="btn btn-outline-primary" prompt="Older"><p>Converting with ffmpeg</p></a> <a href="/posts/spining-up-Uptime-Kuma/" class="btn btn-outline-primary" prompt="Newer"><p>Spining up Uptime Kuma</p></a></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/Harrison-S1">Sam</a>.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/howto-s/">howto's</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/sysops/">sysops</a> <a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/ansible/">ansible</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/terraform/">terraform</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-TSY28JSKB0"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-TSY28JSKB0'); }); </script>
